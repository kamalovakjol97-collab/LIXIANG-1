# Деплой на хостинг Spaceweb

Краткая инструкция по переносу сайта XGL на хостинг Spaceweb (сайт + БД + деплой).

---

## 1. Что нужно на Spaceweb

- **Хостинг** с поддержкой статики (HTML, CSS, JS) и по возможности **PHP** (если позже захотите свою БД на Spaceweb).
- **FTP-доступ** (логин/пароль в панели Spaceweb).
- **База данных**: сейчас заявки уходят в **Supabase**. Варианты:
  - **Вариант A** — оставить Supabase (облако), на Spaceweb только фронт.
  - **Вариант B** — перенести заявки в MySQL/PostgreSQL на Spaceweb и принять форму через PHP (см. раздел 5).

---

## 2. Сборка проекта (подробно)

Сборка — это превращение исходного кода (React, Vite) в готовые файлы сайта (HTML, CSS, JS), которые потом загружаются на хостинг. Всё делается на вашем компьютере, в папке с проектом.

### 2.1. Открыть папку проекта

- Откройте папку, где лежит сайт (например, `C:\Users\...\LIXIANG-1` или `Documents\GitHub\LIXIANG-1`).
- В этой папке должны быть файлы: `package.json`, `vite.config.js`, папки `src` и `public`.

### 2.2. Открыть терминал в этой папке

**Вариант A — через Cursor / VS Code**  
- Меню **Terminal → New Terminal** (или `` Ctrl+` ``).  
- Терминал откроется в корне проекта. Должна быть строка вроде:  
  `C:\...\LIXIANG-1>` или `.../LIXIANG-1 $`.

**Вариант B — через Проводник Windows**  
- В Проводнике откройте папку проекта.  
- В адресной строке введите `cmd` и нажмите Enter — откроется командная строка уже в этой папке.

**Вариант C — вручную**  
- Откройте «Командную строку» или «PowerShell».  
- Перейдите в папку проекта, например:  
  `cd C:\Users\ВашеИмя\Documents\GitHub\LIXIANG-1`  
  (подставьте свой путь).

### 2.3. Установить зависимости (один раз)

В терминале выполните:

```bash
npm install
```

- Что происходит: скачиваются библиотеки из `package.json` (React, Vite и др.) в папку `node_modules`.  
- Длится 1–3 минуты. В конце не должно быть красных ошибок.  
- Эту команду нужно выполнять только при первом развёртывании или после смены компьютера/клона репозитория.

### 2.4. Настроить Supabase (если форма заявок должна работать)

Если заявки с сайта должны сохраняться в Supabase:

1. **Создать файл `.env`** в **корне проекта** (рядом с `package.json`), не в папке `src`.
2. **Имя файла точно:** `.env` (с точкой в начале, без расширения).
3. **Содержимое файла** (подставьте свои данные из панели Supabase):

```env
VITE_SUPABASE_URL=https://xxxxxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Где взять значения:**

- Зайдите в [supabase.com](https://supabase.com) → ваш проект.
- **Settings → API**:  
  - **Project URL** → это `VITE_SUPABASE_URL`.  
  - **Project API keys → anon public** → это `VITE_SUPABASE_ANON_KEY`.
- Скопируйте значения без пробелов и кавычек.

**Важно:** файл `.env` не должен попадать в Git (он уже в `.gitignore`). Его храните только у себя и не выкладывайте в репозиторий.

Если Supabase не используете (или форма пока не нужна), шаг 2.4 можно пропустить — сайт соберётся, но отправка заявки может не работать до настройки ключей.

### 2.5. Запустить сборку

В том же терминале выполните:

```bash
npm run build
```

- Что происходит: Vite собирает проект: минифицирует JS и CSS, подставляет переменные из `.env` (если они заданы) и кладёт результат в папку **`dist`**.
- Обычно занимает 10–30 секунд.
- В конце должно быть что-то вроде:  
  `✓ built in ...` и путь к `dist`.

Если появятся **ошибки** (красный текст) — пришлите их текст, разберём. Частые причины: не установлены зависимости (нужен шаг 2.3) или опечатка в `.env`.

### 2.6. Проверить результат

После успешной сборки:

1. Откройте папку **`dist`** в проекте.
2. В ней должны быть:
   - **`index.html`** — главная страница сайта;
   - папка **`assets`** — в ней файлы с именами вроде `index-xxxxx.js` и `index-xxxxx.css`;
   - папка **`images`** — картинки (герои, иконки и т.д.);
   - файл **`.htaccess`** — нужен для работы ссылок типа `/services`, `/contacts` на хостинге.

Всё содержимое папки **`dist`** — это и есть готовый сайт для загрузки на Spaceweb (см. шаг 3).

### 2.7. Повторная сборка после изменений

Когда вы меняете код или текст на сайте:

1. При необходимости обновите `.env` (если меняли ключи Supabase).
2. В терминале в папке проекта снова выполните:  
   `npm run build`
3. Залейте обновлённое содержимое `dist` на хостинг по FTP (см. раздел 3).

---

## 3. Загрузка на Spaceweb по FTP

1. Подключитесь к хостингу по **FTP** (FileZilla, WinSCP или встроенный менеджер в панели Spaceweb).
2. Откройте каталог, откуда отдаётся сайт (часто **`public_html`** или **`www`**).
3. Загрузите **всё содержимое** папки **`dist`** (не саму папку `dist`, а файлы внутри):
   - `index.html` — в корень (например, в `public_html/`)
   - папка `assets/` — целиком
   - папка `images/` — целиком (если есть)
   - файл **`.htaccess`** — в корень (важен для SPA, см. ниже)

В итоге в корне сайта должны лежать: `index.html`, `.htaccess`, `assets/`, `images/` и т.д.

---

## 4. SPA и маршруты (React Router)

Сайт — одностраничное приложение: все пути (`/services`, `/history`, `/contacts`, `/faq`, `/privacy`) должны отдавать один и тот же `index.html`. Для этого в корень загружен **`.htaccess`** (он копируется из `public/.htaccess` при сборке).

Если на хостинге **Apache** — правило из `.htaccess` перенаправит любой несуществующий путь на `index.html`. Если у вас **nginx** — в панели Spaceweb может быть раздел «Настройка nginx»; туда нужно добавить аналог:

```nginx
location / {
  try_files $uri $uri/ /index.html;
}
```

---

## 5. База данных

### Вариант A: Supabase (как сейчас)

- Ничего не меняете в коде.
- В Supabase создаёте проект и таблицу по скрипту `supabase-setup-fix.sql`.
- Перед каждой сборкой задаёте в `.env` переменные `VITE_SUPABASE_URL` и `VITE_SUPABASE_ANON_KEY`, затем `npm run build` и заливаете обновлённый `dist` по FTP.

Заявки с формы будут сохраняться в Supabase.

### Вариант B: БД на Spaceweb (MySQL/PostgreSQL)

Если хотите хранить заявки в БД на Spaceweb:

1. В панели Spaceweb создайте базу MySQL или PostgreSQL и пользователя.
2. Создайте таблицу заявок (аналог структуры из `supabase-setup-fix.sql`, с полями под вашу форму).
3. Нужен **backend**: например, PHP-скрипт на том же хостинге, который принимает POST с формы и вставляет запись в БД.
4. Во фронте заменить отправку через Supabase на отправку на этот PHP (например, `fetch('/api/application.php', ...)`).

Такой вариант потребует правок в коде (форма + один PHP-файл). Если выберете его — можно отдельно описать структуру API и пример PHP.

---

## 6. Обновление сайта (релизы)

1. Вносите изменения в коде.
2. Локально: `npm run build`.
3. По FTP заливаете содержимое `dist` в корень сайта на Spaceweb (можно перезаписать только изменённые файлы).

При желании можно автоматизировать выкладку скриптом (FTP из командной строки) или через Git + CI на другом сервисе, который будет собирать проект и заливать на Spaceweb по FTP.

---

## 7. Проверка после переноса

- Откройте главную страницу и разделы: Услуги, История, Контакты, FAQ, Политика конфиденциальности.
- Проверьте, что переход по прямым ссылкам (например, `ваш-сайт.ru/services`) открывает нужную страницу, а не 404.
- Отправьте тестовую заявку с формы и убедитесь, что она появляется в Supabase (или в БД на Spaceweb, если настроили Вариант B).

---

## Файлы в проекте, важные для Spaceweb

| Файл / папка | Назначение |
|--------------|------------|
| `public/.htaccess` | Правила для Apache, чтобы SPA (React Router) работал. Копируется в `dist` при сборке. |
| `dist/` | Результат `npm run build` — это и есть то, что заливать на хостинг. |
| `.env` | Не коммитить в Git. Нужен только локально для сборки (Supabase URL и ключ). |
| `supabase-setup-fix.sql` | Скрипт для создания таблицы заявок в Supabase (или как образец для своей БД). |

Если решите перейти на БД на Spaceweb и PHP — напишите, подготовлю пример скрипта приёма заявки и структуру таблицы под вашу форму.
